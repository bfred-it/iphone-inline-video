/*! npm.im/iphone-inline-video */
var makeVideoPlayableInline=function(){"use strict";function e(e){function r(t){i=requestAnimationFrame(r),e(t-(n||t)),n=t}var i,n;this.start=function(){i||r(0)},this.stop=function(){cancelAnimationFrame(i),i=null,n=0}}function r(e,r,i,n){function t(r){var t=r.detail&&r.detail.proxied;t||Boolean(e[i])!==Boolean(n)||r.stopImmediatePropagation(),delete e[i]}return e.addEventListener(r,t,!1),t}function i(e,r,i,n){function t(){return i[r]}function d(e){i[r]=e}n&&d(e[r]),Object.defineProperty(e,r,{get:t,set:d})}function n(e,r,i){i.addEventListener(r,function(){return e.dispatchEvent(new CustomEvent(r,{detail:{proxied:!0}}))})}function t(e,r){Promise.resolve().then(function(){e.dispatchEvent(new Event(r))})}function d(e){var r=new Audio;return n(e,"play",r),n(e,"playing",r),n(e,"pause",r),n(e,"timeupdate",r),n(e,"seeking",r),n(e,"seeked",r),r.crossOrigin=e.crossOrigin,r.src=e.src||e.currentSrc||"data:",r}function a(e,r,i){(f||0)+200<Date.now()&&(e[h]=!0,f=Date.now()),i||(e.currentTime=r),T[++k%3]=100*r|0}function o(e){return e.driver.currentTime>=e.video.duration}function u(e){var r=this;r.video.readyState>=r.video.HAVE_FUTURE_DATA?(r.hasAudio||(r.driver.currentTime=r.video.currentTime+e*r.video.playbackRate/1e3,r.video.loop&&o(r)&&(r.driver.currentTime=0)),a(r.video,r.driver.currentTime)):r.video.networkState!==r.video.NETWORK_IDLE||r.video.buffered.length||r.video.load(),r.video.ended&&(delete r.video[h],r.video.pause(!0))}function s(){var e=this,r=e[g];return e.webkitDisplayingFullscreen?void e[b]():("data:"!==r.driver.src&&r.driver.src!==e.src&&(a(e,0,!0),r.driver.src=e.src),void(e.paused&&(r.paused=!1,e.buffered.length||e.load(),r.driver.play(),r.updater.start(),r.hasAudio||(t(e,"play"),r.video.readyState>=r.video.HAVE_ENOUGH_DATA&&t(e,"playing")))))}function c(e){var r=this,i=r[g];i.driver.pause(),i.updater.stop(),r.webkitDisplayingFullscreen&&r[E](),i.paused&&!e||(i.paused=!0,i.hasAudio||t(r,"pause"),r.ended&&(r[h]=!0,t(r,"ended")))}function v(r,i){var n=r[g]={};n.paused=!0,n.hasAudio=i,n.video=r,n.updater=new e(u.bind(n)),i?n.driver=d(r):(r.addEventListener("canplay",function(){r.paused||t(r,"playing")}),n.driver={src:r.src||r.currentSrc||"data:",muted:!0,paused:!0,pause:function(){n.driver.paused=!0},play:function(){n.driver.paused=!1,o(n)&&a(r,0)},get ended(){return o(n)}}),r.addEventListener("emptied",function(){var e=!n.driver.src||"data:"===n.driver.src;n.driver.src&&n.driver.src!==r.src&&(a(r,0,!0),n.driver.src=r.src,e?n.driver.play():n.updater.stop())},!1),r.addEventListener("webkitbeginfullscreen",function(){r.paused?i&&!n.driver.buffered.length&&n.driver.load():(r.pause(),r[b]())}),i&&(r.addEventListener("webkitendfullscreen",function(){n.driver.currentTime=r.currentTime}),r.addEventListener("seeking",function(e){e.detail&&e.detail.proxied||T.indexOf(100*r.currentTime|0)<0&&(n.driver.currentTime=r.currentTime)}))}function p(e){var n=e[g];e[b]=e.play,e[E]=e.pause,e.play=s,e.pause=c,i(e,"paused",n.driver),i(e,"muted",n.driver,!0),i(e,"playbackRate",n.driver,!0),i(e,"ended",n.driver),i(e,"loop",n.driver,!0),r(e,"seeking"),r(e,"seeked"),r(e,"timeupdate",h,!1),r(e,"ended",h,!1)}function l(e,r,i){void 0===r&&(r=!0),void 0===i&&(i=!0),i&&!y||e[g]||(v(e,r),p(e),e.classList.add("IIV"),!r&&e.autoplay&&e.play(),"MacIntel"!==navigator.platform&&"Windows"!==navigator.platform||console.warn("iphone-inline-video is not guaranteed to work in emulated environments"))}var f,m="undefined"==typeof Symbol?function(e){return"@"+(e||"@")+Math.random()}:Symbol,y=/iPhone|iPod/i.test(navigator.userAgent)&&void 0===document.head.style.grid,g=m(),h=m(),b=m("nativeplay"),E=m("nativepause"),T=[],k=0;return l.isWhitelisted=y,l}();